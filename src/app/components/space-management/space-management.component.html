<div class="spaces-management-container">
    <header class="spaces-header">
        <h1>Gestión de Espacios</h1>
        <p>Aquí puedes gestionar los espacios de parqueo disponibles y ocupados.</p>
    </header>

    <div class="spaces-content">
        <!-- Filtros y Búsqueda -->
        <div class="filter-bar">
            <input type="text" placeholder="Buscar por número de espacio..." [(ngModel)]="searchNumber" />
            <select [(ngModel)]="filterStatus" >
                <option value="">Todos</option>
                <option value="disponible">Disponible</option>
                <option value="ocupado">Ocupado</option>
            </select>
            <select [(ngModel)]="filterType" >
                <option value="">Todos</option>
                <option value="normal">Normal</option>
                <option value="discapacitados">Discapacitados</option>
            </select>
        </div>

        <!-- Tabla de Espacios -->
        <table class="spaces-table">
            <thead>
                <tr>
                    <th>Número de Espacio</th>
                    <th>Estado</th>
                    <th>Tipo de Espacio</th>
                    <th>Precio</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let space of getFilteredSpaces()">
                    <td>{{ space.number }}</td>
                    <td>{{ space.status }}</td>
                    <td>{{ space.type }}</td>
                    <td>{{ space.price }}</td>
                    <td>
                        <button (click)="editSpace(space)">Editar</button>
                        <button *ngIf="space.status === 'Disponible'" (click)="reserveSpace(space)">Reservar</button>
                        <button *ngIf="space.status === 'Ocupado'" (click)="freeSpace(space)">Liberar</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Formulario para Añadir o Editar Espacio -->
        <div class="space-form">
            <h2>{{ isEditing ? 'Editar Espacio' : 'Añadir Nuevo Espacio' }}</h2>
            <form (submit)="saveSpace(); $event.preventDefault()">
                <input type="number" [(ngModel)]="spaceForm.number" placeholder="Número de Espacio" name = "number" required />
                <select [(ngModel)]="spaceForm.status" name = "status" required>
                    <option value="Disponible">Disponible</option>
                    <option value="Ocupado">Ocupado</option>
                </select>
                <select [(ngModel)]="spaceForm.type" name = "type" required>
                    <option value="Normal">Normal</option>
                    <option value="Discapacitados">Discapacitados</option>
                </select>
                <input type="number" [(ngModel)]="spaceForm.price" placeholder="Precio por hora" name = "price" required />
                    <div *ngIf="message" class="success-message">
                        {{ message }}
                    </div>
                <button type="submit">{{ isEditing ? 'Actualizar' : 'Guardar' }}</button>
                <button type="button" (click)="cancelEdit()">Cancelar</button>
            </form>
        </div>
    </div>
</div>